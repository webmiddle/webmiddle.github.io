<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Node.js JSX framework for modular web scraping and data integration">
    <title>Documentation | webmiddle</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="../../../assets/css/bootstrap.min.css">

    <!-- Prism CSS customized to match github style -->
    <link rel="stylesheet" href="../../../assets/css/prism-custom.css">

    <!-- Custom styles for this template -->
    <link href="../../../assets/css/theme.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>

    
<!-- Fixed navbar -->
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../index.html">webmiddle</a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <!-- you can exclude pages using {{#isnt}} helper: {{#isnt data.title 'Blog'}} -->
        
        <li>
          <a href="/">Home</a>
        </li>
        
        <li class="active">
          <a href="/docs">Documentation</a>
        </li>
        
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</div>


    <div class="container theme-showcase content" role="main">

      
<div class="content-header">
    <div class="container">
        <h1>Documentation</h1>
        <p>Learn how to use the framework effectively.</p>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="col-lg-3 sidebar">
            <!-- Sidebar -->
            <ul class="nav">      <li>        <a href="/docs/introduction.html">Introduction</a>              </li>          <li>        <a href="/docs/getting_started.html">Getting started</a>              </li>          <li>        <a href="/docs/overview.html">Overview</a>        <ul class="nav">      <li>        <a href="/docs/jsx_components.html">JSX components</a>              </li>          <li>        <a href="/docs/webmiddle_objects.html">webmiddle objects</a>              </li>          <li>        <a href="/docs/multiple_layers.html">Multiple layers</a>              </li>    </ul>      </li>          <li>        <a href="/docs/advanced/index.html">Advanced</a>        <ul class="nav">      <li>        <a href="/docs/advanced/context.html">context</a>              </li>          <li>        <a href="/docs/advanced/evaluate.html">evaluate</a>        <ul class="nav">      <li>        <a href="/docs/advanced/callvirtual.html">callVirtual</a>              </li>    </ul>      </li>    </ul>      </li>          <li>        <a href="/docs/packages.html">Packages</a>              </li>          <li>        <a href="/docs/example/index.html">Example: News Search</a>        <ul class="nav">      <li>        <a href="/docs/example/site_webmiddles/index.html">Site webmiddles</a>        <ul class="nav">      <li>        <a href="/docs/example/site_webmiddles/fox_news.html">Fox News</a>              </li>          <li>        <a href="/docs/example/site_webmiddles/the_new_york_times.html">The New York Times</a>              </li>    </ul>      </li>          <li>        <a href="/docs/example/project_webmiddle/index.html">Project webmiddle</a>        <ul class="nav">      <li>        <a href="/docs/example/project_webmiddle/site_handler.html">Site handler</a>              </li>          <li>        <a href="/docs/example/project_webmiddle/meta.html">Meta</a>              </li>          <li>        <a href="/docs/example/project_webmiddle/articledetails.html">ArticleDetails</a>              </li>          <li>        <a class="active" href="/docs/example/project_webmiddle/searcharticles.html">SearchArticles</a>              </li>          <li>        <a href="/docs/example/project_webmiddle/business_logic.html">Business logic</a>              </li>          <li>        <a href="/docs/example/project_webmiddle/main.html">Main</a>              </li>          <li>        <a href="/docs/example/project_webmiddle/sitemain.html">SiteMain</a>              </li>          <li>        <a href="/docs/example/project_webmiddle/processpage.html">ProcessPage</a>              </li>          <li>        <a href="/docs/example/project_webmiddle/filtering_and_merging.html">Filtering and merging</a>              </li>    </ul>      </li>          <li>        <a href="/docs/example/sample_execution.html">Sample execution</a>              </li>    </ul>      </li>    </ul>
        </div>

        <div class="col-lg-9">
            <!-- Content -->
            <div class="page-header">
                <h3 id="searcharticles">SearchArticles</h3>
<p>Must return an array of article objects.</p>
<p>The wrapper for foxnews.com is straightforward:</p>
<pre><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">SearchArticles</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Pipe</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Parent</span>
        <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span>
        <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>page<span class="token punctuation">"</span></span>
      <span class="token punctuation">/></span></span>

      <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">{</span> page <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'searchArticles'</span><span class="token punctuation">,</span>
        contentType<span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
        content<span class="token punctuation">:</span> page<span class="token punctuation">.</span>content<span class="token punctuation">.</span>root<span class="token punctuation">.</span>articles<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
          article <span class="token operator">=></span> article<span class="token punctuation">.</span>article
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Pipe</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Basically, our parent component returns an object like</p>
<pre><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"page"</span><span class="token punctuation">,</span>
  <span class="token string">"contentType"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span><span class="token punctuation">,</span>
  <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"root"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">"count"</span><span class="token punctuation">:</span> <span class="token number">1233</span><span class="token punctuation">,</span>
      <span class="token string">"articles"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        <span class="token string">"article"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token comment">//[the actual article object]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string">"article"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token comment">//[the actual article object]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>Thus, we are just extracting each “actual article object” into an array.</p>
<p><br />
In the other end, the wrapper for <strong>nytimes.com</strong> requires more work.
This is because as we saw from the previous section, the site provides a
useful JSON API for searching articles, thus our parent SearchArticles
component just calls such API and returns the output as is.</p>
<p>That JSON output needs to be converted into the project format:</p>
<pre><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">SearchArticles</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  nytimesApiKey<span class="token punctuation">,</span> <span class="token operator">...</span>rest
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Pipe</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Parent</span>
        <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">rest</span><span class="token punctuation">}</span></span>
        <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>page<span class="token punctuation">"</span></span>
        <span class="token attr-name">apiKey</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>nytimesApiKey<span class="token punctuation">}</span></span>
      <span class="token punctuation">/></span></span>

      <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">{</span> page <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>JSONSelectToJson</span>
          <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>searchArticles<span class="token punctuation">"</span></span>
          <span class="token attr-name">from</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>page<span class="token punctuation">}</span></span>
        <span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>articles</span> <span class="token attr-name">el</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.docs > *<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token punctuation">{</span><span class="token function">elMap</span><span class="token punctuation">(</span>el <span class="token operator">=></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">el</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>el<span class="token punctuation">}</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span> <span class="token attr-name">el</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.web_url<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token function">elGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span> <span class="token attr-name">el</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.headline > .main<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token function">elGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span> <span class="token attr-name">el</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.snippet<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token function">elGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>date</span> <span class="token attr-name">el</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.pub_date<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                  <span class="token punctuation">{</span><span class="token function">elPipe</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                    <span class="token function">elGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    dateString <span class="token operator">=></span> <span class="token function">getFormattedDate</span><span class="token punctuation">(</span>
                      <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>dateString<span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>date</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>
                  <span class="token attr-name">el</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.multimedia > *<span class="token punctuation">"</span></span>
                  <span class="token attr-name">condition</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>currEl <span class="token operator">=></span>
                    currEl<span class="token punctuation">.</span>subtype <span class="token operator">===</span> <span class="token string">'thumbnail'</span><span class="token punctuation">}</span></span>
                <span class="token punctuation">></span></span>
                  <span class="token punctuation">{</span><span class="token function">elPipe</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                    <span class="token function">elGet</span><span class="token punctuation">(</span><span class="token string">'.url'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    relativeUrl <span class="token operator">=></span> relativeUrl <span class="token operator">?</span>
                      <span class="token template-string"><span class="token string">`http://www.nytimes.com/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>relativeUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
                      <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
                  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">></span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>
            <span class="token punctuation">)</span><span class="token punctuation">}</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>articles</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>JSONSelectToJson</span><span class="token punctuation">></span></span>
      <span class="token punctuation">}</span>

      <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">{</span> searchArticles <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'searchArticles'</span><span class="token punctuation">,</span>
        contentType<span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
        content<span class="token punctuation">:</span> searchArticles<span class="token punctuation">.</span>content<span class="token punctuation">.</span>root<span class="token punctuation">.</span>articles<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
          article <span class="token operator">=></span> article<span class="token punctuation">.</span>article
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Pipe</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>The <strong>JSONSelectToJson</strong> core component is used to convert the existing
JSON resource into a new JSON resource with a given schema. As the name
suggests, it uses the <strong>JSONSelect</strong> library for navigating and querying
the JSON object.</p>
<p>Such library provides CSS-like selectors which resemble those used in
jQuery / cheerio.</p>
<p>Here, as in the CheerioToJson conversion, the “el” actually represents a
collection of elements, however here a collection is just a plain
JavaScript array, thus we can use the standard JavaScript functions to
manipulate it.</p>
<p>For convenience, the JSONSelectToJson component still provides some helper
functions, such as the <strong>elGet</strong> helper.</p>
<p>Such helper, given an el (a collection of elements), just returns the
value of the first element in the collection. Moreover, it accepts an
optional selector as parameter, which is used to query the collection
before returning the first element.</p>
<p><hr />
Example:</p>
<pre><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>
  <span class="token attr-name">el</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.multimedia > *<span class="token punctuation">"</span></span>
  <span class="token attr-name">condition</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>currEl <span class="token operator">=></span> currEl<span class="token punctuation">.</span>subtype <span class="token operator">===</span> <span class="token string">'thumbnail'</span><span class="token punctuation">}</span></span>
<span class="token punctuation">></span></span>
  <span class="token punctuation">{</span><span class="token function">elPipe</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token function">elGet</span><span class="token punctuation">(</span><span class="token string">'.url'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    relativeUrl <span class="token operator">=></span> relativeUrl <span class="token operator">?</span>
      <span class="token template-string"><span class="token string">`http://www.nytimes.com/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>relativeUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">></span></span></code></pre>
<p>Here, with <code>.multimedia &gt; *</code> we are selecting all the children of
the <code>multimedia</code> object. Then we apply a condition to furtherly
restrict the set of objects to select: all those with the <code>subtype</code>
property set to <code>thumbnail</code>.</p>
<p>The value of the image element is obtained by piping two separate steps:</p>
<ul>
<li><p><code>elGet(&#39;.url&#39;)</code>: we are finding the first element (property) named
<code>url</code> which exists in our collection at any level of dept.</p>
</li>
<li><p>since such url contains a relative url to the article thumbnail, we
are then creating an absolute url by prefixing it.</p>
</li>
</ul>
<hr />

            </div>
            <div class="page-nav">
                
                <span class="previous">Previous: <a href="/docs/example/project_webmiddle/articledetails.html">ArticleDetails</a></span>
                
                
                <span class="next">Next: <a href="/docs/example/project_webmiddle/business_logic.html">Business logic</a></span>
                
            </div>
        </div>
    </div>
</div>

    </div>

    <footer class="footer text-center text-muted">
  <p>
    <span><a href="https://github.com/webmiddle/webmiddle">webmiddle</a></span>
     · 
    <span>MIT © <a href="https://github.com/Maluen">Manuel Dell&#x27;Elce</a></span>
  </p>
  <p>
    Found an issue with the docs? Report it <a href="https://github.com/webmiddle/webmiddle.github.io/issues">here</a>.
  </p>
</footer>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="../../../assets/js/bootstrap.min.js"></script>
  </body>
</html>
